@page "/registration"
@using Microsoft.AspNetCore.Components.Forms
@using Microsoft.AspNetCore.Components
@using SupportSystemCofe.Shared.Models
@using SupportSystemCofe.Client.Services
@inject RegistrationService RegistrationService


<div>
    <h2>Регистрация</h2>
    <EditForm Model="RegistrationData" OnValidSubmit="HandleSubmit">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <fieldset>
            <legend>Контактные данные</legend>

            <div>
                <label>ФИО:</label>
                <InputText @bind="RegistrationData.FullName" />
            </div>

            <div>
                <label>Email:</label>
                <InputText @bind="RegistrationData.Email" type="email" />
            </div>

            <div>
                <label>Номер телефона:</label>
                <InputText @bind="RegistrationData.Phone" />
            </div>

            <div>
                <label>Пароль:</label>
                <InputText @bind="RegistrationData.Password" type="password" />
            </div>

            <div>
                <label>Выбор роли:</label>
                <select @bind="SelectedRole">
                    <option value="">Выберите роль</option>
                    <option value="admin">Администратор</option>
                    <option value="user">Пользователь</option>
                </select>
            </div>
        </fieldset>

        <fieldset>
            <legend>Регистрация бизнеса</legend>

            <div>
                <label>Название бизнеса:</label>
                <InputText @bind="RegistrationData.BusinessName" />
            </div>

            <div>
                <label>Сфера деятельности:</label>
                <InputText @bind="RegistrationData.Industry" />
            </div>

            <div>
                <label>Этап бизнеса:</label>
                <select @bind="SelectedBusinessStage">
                    <option value="">Выберите этап</option>
                    <option value="startup">Стартап</option>
                    <option value="growing">Развивающийся</option>
                    <option value="established">Стабильный</option>
                </select>
            </div>

            <div>
                <label>Регион:</label>
                <InputText @bind="RegistrationData.Region" />
            </div>

            <div>
                <label>Масштаб бизнеса:</label>
                <select @bind="SelectedScale">
                    <option value="">Выберите масштаб</option>
                    <option value="small">Малый</option>
                    <option value="medium">Средний</option>
                    <option value="large">Крупный</option>
                </select>
            </div>

            <div>
                <label>Сфера деятельности:</label>
                <div>
                    <label><input type="radio" @bind="SelectedActivity"  /> Найти клиентов</label>
                    <label><input type="radio" @bind="SelectedActivity"  /> Создать продукт</label>
                    <label><input type="radio" @bind="SelectedActivity"  /> Найти поддержку</label>
                    <label><input type="radio" @bind="SelectedActivity"  /> Развить бизнес</label>
                </div>
            </div>

            <div>
                <label>Дополнительные детали:</label>
                <InputTextArea @bind="RegistrationData.Details" rows="4" cols="50" />
            </div>
        </fieldset>

        <button type="submit">Продолжить</button>
    </EditForm>
</div>

@code {
    private RegistrationRequest RegistrationData = new();
    private string SelectedRole { get; set; }
    private string SelectedBusinessStage { get; set; }
    private string SelectedScale { get; set; }
    private string SelectedActivity { get; set; }

    private async Task HandleSubmit()
    {
        var success = await RegistrationService.RegisterAsync(RegistrationData);

        if (success)
        {
            Console.WriteLine("Регистрация успешна!");
        }
        else
        {
            Console.WriteLine("Ошибка регистрации.");
        }
    }
}
